
<div id="__docusaurus">
<div><a href="" class="skipToContent_frOU">Skip to main content</a></div><div class="announcementBar_p-Lp" style="background-color: rgb(158, 198, 239); color: rgb(9, 30, 66);" role="banner"><div class="announcementBarPlaceholder_wYMd"></div><div class="announcementBarContent_shkk"><a href="https://www.lunasec.io/docs/pages/mailing-list" style="font-size: 15px; text-decoration-line: none;">Subscribe to our mailing list to get the latest security news and product updates.</a></div><button type="button" class="clean-btn close announcementBarClose_q9RK" aria-label="Close"><svg viewBox="0 0 15 15" width="14" height="14"><g stroke="currentColor" stroke-width="3.1"><path d="M.75.75l13.5 13.5M14.25.75L.75 14.25"></path></g></svg></button></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="https://www.lunasec.io/docs/"><div class="navbar__logo"><img src="_files/logo-black-text_500px.svg" alt="LunaSec Logo" class="themedImage_W1tg themedImage--light_hd0z"><img src="_files/logo-white-text.svg" alt="LunaSec Logo" class="themedImage_W1tg themedImage--dark_o1hR"></div></a><a class="navbar__item navbar__link" href="https://www.lunasec.io/docs/pages/lunatrace/overview/introduction/">LunaTrace</a><a class="navbar__item navbar__link" href="https://www.lunasec.io/docs/pages/lunadefend/overview/introduction/">LunaDefend</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="https://www.lunasec.io/docs/blog/">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://www.lunasec.io/contact" target="_blank" rel="" class="navbar__item navbar__link"><span>Contact Us<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_x5Nv"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><a href="https://github.com/lunasec-io/lunasec" target="_blank" rel="noopener" class="navbar__item navbar__link github-nav-link"><span> GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_x5Nv"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="toggle_G6S1 toggle_EyZc toggleDisabled_zlAx"><div class="toggleTrack_jpPc" role="button" tabindex="-1"><div class="toggleTrackCheck_EeFq"><span class="toggleIcon_wqZl">üåú</span></div><div class="toggleTrackX_svF-"><span class="toggleIcon_wqZl">üåû</span></div><div class="toggleTrackThumb_p73L"></div></div><input type="checkbox" class="toggleScreenReader_YBn+" aria-label="Switch between dark and light mode"></div><div class="searchBox_tMoM"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper blog-wrapper blog-post-page"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_yFnW thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_ArL8 margin-bottom--md">All Posts</div><ul class="sidebarItemList_ZMUO"><li class="sidebarItem_VWbM"><a class="sidebarItemLink_9oUq" href="https://www.lunasec.io/docs/blog/text4shell-java-rce-cve-2022-42889/">Text4Shell: A Vulnerability in Java library Apache Commons Text (CVE-2022-42889, Act4Shell)</a></li><li class="sidebarItem_VWbM"><a class="sidebarItemLink_9oUq" href="https://www.lunasec.io/docs/blog/security-guide-for-startups/">Security Guide for Startups: How to think about security while moving quickly</a></li><li class="sidebarItem_VWbM"><a class="sidebarItemLink_9oUq" href="https://www.lunasec.io/docs/blog/vex-silence-false-positives/">VEX: Permanently Silence False Positives with Vulnerability EXchange</a></li><li class="sidebarItem_VWbM"><a class="sidebarItemLink_9oUq" href="https://www.lunasec.io/docs/blog/bun-first-look/">Bun: A Complete Overhaul of the JavaScript Ecosystem</a></li><li class="sidebarItem_VWbM"><a class="sidebarItemLink_9oUq" href="https://www.lunasec.io/docs/blog/ctx-and-phpass-package-malware/">How two Python and PHP dependencies, ctx and Phpass, became malware that stole secrets and credentials</a></li><li class="sidebarItem_VWbM"><a class="sidebarItemLink_9oUq" href="https://www.lunasec.io/docs/blog/the-issue-with-vuln-scanners/">False Positives in Vulnerability Scanning: Why We Think We Can Do Better</a></li><li class="sidebarItem_VWbM"><a aria-current="page" class="sidebarItemLink_9oUq sidebarItemLinkActive_uIEe" href="">Arch Linux Installation Guide For Developers</a></li><li class="sidebarItem_VWbM"><a class="sidebarItemLink_9oUq" href="https://www.lunasec.io/docs/blog/spring-rce-vulnerabilities/">Spring4Shell: Security Analysis of the latest Java RCE '0-day' vulnerabilities in Spring</a></li><li class="sidebarItem_VWbM"><a class="sidebarItemLink_9oUq" href="https://www.lunasec.io/docs/blog/node-ipc-protestware/">Protestware - How node-ipc turned into malware</a></li><li class="sidebarItem_VWbM"><a class="sidebarItemLink_9oUq" href="https://www.lunasec.io/docs/blog/log4j-hype-train/">Newest Vulnerability in Log4j 2.17.0 more hype than substance</a></li><li class="sidebarItem_VWbM"><a class="sidebarItemLink_9oUq" href="https://www.lunasec.io/docs/blog/lunasec-story/">LunaDefend can help protect against Open Source vulnerabilities</a></li><li class="sidebarItem_VWbM"><a class="sidebarItemLink_9oUq" href="https://www.lunasec.io/docs/blog/log4j-zero-day-mitigation-guide/">Guide: How To Detect and Mitigate the Log4Shell Vulnerability (CVE-2021-44228 &amp; CVE-2021-45046)</a></li><li class="sidebarItem_VWbM"><a class="sidebarItemLink_9oUq" href="https://www.lunasec.io/docs/blog/log4j-zero-day-update-on-cve-2021-45046/">Log4Shell Update: Second log4j Vulnerability Published (CVE-2021-44228 + CVE-2021-45046)</a></li><li class="sidebarItem_VWbM"><a class="sidebarItemLink_9oUq" href="https://www.lunasec.io/docs/blog/log4shell-live-patch/">How to Automatically Mitigate Log4Shell via a Live Patch (CVE-2021-44228 + CVE-2021-45046)</a></li><li class="sidebarItem_VWbM"><a class="sidebarItemLink_9oUq" href="https://www.lunasec.io/docs/blog/log4j-zero-day-severity-of-cve-2021-45046-increased/">Log4Shell Update: Severity Upgraded 3.7 to 9.0 for Second log4j Vulnerability (CVE-2021-45046)</a></li><li class="sidebarItem_VWbM"><a class="sidebarItemLink_9oUq" href="https://www.lunasec.io/docs/blog/how-to-mitigate-open-source/">How to Discuss and Fix Vulnerabilities in Your Open Source Library</a></li><li class="sidebarItem_VWbM"><a class="sidebarItemLink_9oUq" href="https://www.lunasec.io/docs/blog/log4shell-live-patch-technical/">Understanding Log4Shell via Exploitation and Live Patching (CVE-2021-44228 + CVE-2021-45046)</a></li><li class="sidebarItem_VWbM"><a class="sidebarItemLink_9oUq" href="https://www.lunasec.io/docs/blog/log4j-zero-day/">Log4Shell: RCE 0-day exploit found in log4j, a popular Java logging package</a></li><li class="sidebarItem_VWbM"><a class="sidebarItemLink_9oUq" href="https://www.lunasec.io/docs/blog/csp/">Why your Content Security Policy isn't as secure as you think</a></li><li class="sidebarItem_VWbM"><a class="sidebarItemLink_9oUq" href="https://www.lunasec.io/docs/blog/how-data-breaches-happen-and-why-secure-by-default-software-is-the-future/">How Data Breaches happen and why Secure by Default software is the future</a></li><li class="sidebarItem_VWbM"><a class="sidebarItemLink_9oUq" href="https://www.lunasec.io/docs/blog/buildkit/">BuildKit intermediate caching in CI</a></li><li class="sidebarItem_VWbM"><a class="sidebarItemLink_9oUq" href="https://www.lunasec.io/docs/blog/how-to-build-an-open-source-business-in-2021-part-1/">How to build an Open Source Business in 2021 (Part 1)</a></li><li class="sidebarItem_VWbM"><a class="sidebarItemLink_9oUq" href="https://www.lunasec.io/docs/blog/lunasec-ci/">End-to-End testing a MonoRepo</a></li><li class="sidebarItem_VWbM"><a class="sidebarItemLink_9oUq" href="https://www.lunasec.io/docs/blog/testing-philosophy/">The Importance of Testing</a></li><li class="sidebarItem_VWbM"><a class="sidebarItemLink_9oUq" href="https://www.lunasec.io/docs/blog/lunasec-v1-public-release/">LunaDefend v1 Public Release</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="http://schema.org/Blog"><article itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h1 class="blogPostTitle_uZHr" itemprop="headline">Arch Linux Installation Guide For Developers</h1><div class="blogPostData_Rndy margin-vert--md"><time datetime="2022-05-04T00:00:00.000Z" itemprop="datePublished">May 4, 2022</time> ¬∑ 8 min read</div><div class="row margin-top--md margin-bottom--sm"><div class="col col--6 authorCol_5D9I"><div class="avatar margin-bottom--sm"><a href="https://github.com/g00b" target="_blank" rel="noopener noreferrer" class="avatar__photo-link avatar__photo"><img class="image_NYsv" src="https://github.com/g00b.png" alt="Gabe Martino"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/g00b" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Gabe Martino</span></a></div><small class="avatar__subtitle" itemprop="description">Developer at LunaSec</small></div></div></div></div></header><meta itemprop="image" content="https://www.lunasec.io/docs/img/clippy_arch.jpeg"><div class="markdown" itemprop="articleBody"><p><img src="_files/clippy_arch.jpeg" alt="Arch Linux Install"></p><h2 class="anchor anchorWithStickyNavbar_iYD6" id="btw-we-use-arch">BTW we use Arch<a aria-hidden="true" class="hash-link" href="#btw-we-use-arch" title="Direct link to heading">‚Äã</a></h2><p>Here at LunaSec not only have we been busy hacking, but we've also onboarded a couple new team members WOOHOO ü•≥! Through the onboarding process, we realized there is an opportunity to
release our developer environment setup as a guide for the community.</p><p>We're sharing this guide to both show how we are using Arch Linux as Security Engineers at LunaSec and to give confidence to developers considering making the switch to Arch.</p><h2 class="anchor anchorWithStickyNavbar_iYD6" id="why-is-arch-the-best-operating-system-for-developers">Why is Arch the best operating system for developers?<a aria-hidden="true" class="hash-link" href="#why-is-arch-the-best-operating-system-for-developers" title="Direct link to heading">‚Äã</a></h2><p>Here are a few of the reasons why we decided to use Arch as our development environment:</p><ul><li>We have direct visibility and control down to the kernel</li><li>We know what's on our system and only use what we deem necessary</li><li>We can configure our environments to meet security standards quickly and seamlessly</li><li>We have access to the latest packages for development</li></ul><p>We found Arch to be that sweet spot between security, accessibility, and productivity. As an Open Source startup, using Open Source software is
fundamental to our values and culture as security professionals.</p><p>Lastly before we begin, here's a friendly shout out to Michael Picht for his <a href="https://nerdstuff.org/posts/2020/2020-004_arch_linux_luks_btrfs_systemd-boot/" target="_blank" rel="noopener noreferrer">guide</a> over at nerdstuff.org.
We referenced it while compiling our own guide and found it very helpful in our work, thanks again Michael üëè.</p><h2 class="anchor anchorWithStickyNavbar_iYD6" id="preparing-for-the-install">Preparing For the Install<a aria-hidden="true" class="hash-link" href="#preparing-for-the-install" title="Direct link to heading">‚Äã</a></h2><p>Grab the version of <a href="https://archlinux.org/download/" target="_blank" rel="noopener noreferrer">Arch</a> you would like to install. Create a bootable USB of the Arch Image you downloaded.
( <a href="https://www.balena.io/etcher/" target="_blank" rel="noopener noreferrer">Etcher</a> is available for Linux or <a href="https://rufus.ie/en/" target="_blank" rel="noopener noreferrer">Rufus</a> for Windows to make your USB boot image. For further guidance please refer to
the <a href="https://wiki.archlinux.org/title/USB_flash_installation_medium" target="_blank" rel="noopener noreferrer">Arch Wiki</a>.)</p><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>Verify secure boot is disabled in the BIOS before continuing to the next steps.</p></div></div><h2 class="anchor anchorWithStickyNavbar_iYD6" id="what-were-installing">What We're Installing<a aria-hidden="true" class="hash-link" href="#what-were-installing" title="Direct link to heading">‚Äã</a></h2><ul><li>A UEFI boot partition using <a href="https://wiki.archlinux.org/title/Systemd-boot" target="_blank" rel="noopener noreferrer">systemd-boot</a></li><li>An Arch Linux partition with <a href="https://wiki.archlinux.org/title/Btrfs" target="_blank" rel="noopener noreferrer">BTRFS</a>. Encrypted with <a href="https://gitlab.com/cryptsetup/cryptsetup" target="_blank" rel="noopener noreferrer">LUKS</a> luks2</li></ul><h2 class="anchor anchorWithStickyNavbar_iYD6" id="beginning-the-install">Beginning the Install<a aria-hidden="true" class="hash-link" href="#beginning-the-install" title="Direct link to heading">‚Äã</a></h2><p>Plug in your Arch USB image from the previous step and boot into it from your BIOS. From here, you'll be using the terminal.</p><p>We recommend installing via SSH to streamline copying over commands.</p><p>To do this you'll connect to the Internet using the <a href="https://man.archlinux.org/man/community/iwd/iwctl.1.en" target="_blank" rel="noopener noreferrer">iwctl</a> tool to connect to your WIFI.</p><p>Open up the iwctl tool:</p><div class="codeBlockContainer_v8t5"><div class="codeBlockContent_sIJ5"><pre tabindex="0" class="prism-code language-undefined codeBlock_Olq5 thin-scrollbar" style="color: rgb(57, 58, 52); background-color: rgb(246, 248, 250);"><code class="codeBlockLines_UN3+"><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">iwctl</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_9IKF clean-btn">Copy</button></div></div><p>Search for your wireless adapter:</p><div class="codeBlockContainer_v8t5"><div class="codeBlockContent_sIJ5"><pre tabindex="0" class="prism-code language-undefined codeBlock_Olq5 thin-scrollbar" style="color: rgb(57, 58, 52); background-color: rgb(246, 248, 250);"><code class="codeBlockLines_UN3+"><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">device list</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_9IKF clean-btn">Copy</button></div></div><p>Scan your local networks with your wireless adapter (wlan0):</p><div class="codeBlockContainer_v8t5"><div class="codeBlockContent_sIJ5"><pre tabindex="0" class="prism-code language-undefined codeBlock_Olq5 thin-scrollbar" style="color: rgb(57, 58, 52); background-color: rgb(246, 248, 250);"><code class="codeBlockLines_UN3+"><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">station wlan0 get-networks</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_9IKF clean-btn">Copy</button></div></div><p>Connect to your network:</p><div class="codeBlockContainer_v8t5"><div class="codeBlockContent_sIJ5"><pre tabindex="0" class="prism-code language-undefined codeBlock_Olq5 thin-scrollbar" style="color: rgb(57, 58, 52); background-color: rgb(246, 248, 250);"><code class="codeBlockLines_UN3+"><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">station wlan0 connect YOUR_NETWORK</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_9IKF clean-btn">Copy</button></div></div><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>If your network is seperated with a space, use quotes for "YOUR NETWORK"</p></div></div><p>Once connected, exit iwctl:</p><div class="codeBlockContainer_v8t5"><div class="codeBlockContent_sIJ5"><pre tabindex="0" class="prism-code language-undefined codeBlock_Olq5 thin-scrollbar" style="color: rgb(57, 58, 52); background-color: rgb(246, 248, 250);"><code class="codeBlockLines_UN3+"><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">exit</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_9IKF clean-btn">Copy</button></div></div><p>Verify your connection works:</p><div class="codeBlockContainer_v8t5"><div class="codeBlockContent_sIJ5"><pre tabindex="0" class="prism-code language-undefined codeBlock_Olq5 thin-scrollbar" style="color: rgb(57, 58, 52); background-color: rgb(246, 248, 250);"><code class="codeBlockLines_UN3+"><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">ping google.com</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_9IKF clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_iYD6" id="enabling-ssh">Enabling SSH<a aria-hidden="true" class="hash-link" href="#enabling-ssh" title="Direct link to heading">‚Äã</a></h2><p>Now that your machine is connected to the internet, enable the SSH protocol and connect to it from your outside computer.</p><p>Start SSH:</p><div class="codeBlockContainer_v8t5"><div class="codeBlockContent_sIJ5"><pre tabindex="0" class="prism-code language-undefined codeBlock_Olq5 thin-scrollbar" style="color: rgb(57, 58, 52); background-color: rgb(246, 248, 250);"><code class="codeBlockLines_UN3+"><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">systemctl start sshd.service</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_9IKF clean-btn">Copy</button></div></div><p>Set a password for root:</p><div class="codeBlockContainer_v8t5"><div class="codeBlockContent_sIJ5"><pre tabindex="0" class="prism-code language-undefined codeBlock_Olq5 thin-scrollbar" style="color: rgb(57, 58, 52); background-color: rgb(246, 248, 250);"><code class="codeBlockLines_UN3+"><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">passwd</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_9IKF clean-btn">Copy</button></div></div><p>Find the machine's IP Address:</p><div class="codeBlockContainer_v8t5"><div class="codeBlockContent_sIJ5"><pre tabindex="0" class="prism-code language-undefined codeBlock_Olq5 thin-scrollbar" style="color: rgb(57, 58, 52); background-color: rgb(246, 248, 250);"><code class="codeBlockLines_UN3+"><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">ip addr show</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_9IKF clean-btn">Copy</button></div></div><p>From your other computer, connect via SSH (You'll be prompted for the root password you just set)</p><div class="codeBlockContainer_v8t5"><div class="codeBlockContent_sIJ5"><pre tabindex="0" class="prism-code language-undefined codeBlock_Olq5 thin-scrollbar" style="color: rgb(57, 58, 52); background-color: rgb(246, 248, 250);"><code class="codeBlockLines_UN3+"><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">ssh "root@&lt;IP-OF-THE-FIRST-PC&gt;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_9IKF clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_iYD6" id="installation-overview">Installation Overview<a aria-hidden="true" class="hash-link" href="#installation-overview" title="Direct link to heading">‚Äã</a></h2><p>Now that you're connected via SSH, you're ready to do the following:</p><ul><li>Create a Systemd boot partition</li><li>Create a Linux Filesystem partition for Arch</li><li>Encrypt your Filesystem Partition with LUKS</li><li>Create BTRFS Sub Volumes on your Linux Filesystem partition</li><li>Install Arch with recommended Packages</li></ul><h2 class="anchor anchorWithStickyNavbar_iYD6" id="create-the-boot-and-filesystem-partitions">Create the Boot and Filesystem partitions<a aria-hidden="true" class="hash-link" href="#create-the-boot-and-filesystem-partitions" title="Direct link to heading">‚Äã</a></h2><p>Identify the drive on which to install Arch:</p><div class="codeBlockContainer_v8t5"><div class="codeBlockContent_sIJ5"><pre tabindex="0" class="prism-code language-undefined codeBlock_Olq5 thin-scrollbar" style="color: rgb(57, 58, 52); background-color: rgb(246, 248, 250);"><code class="codeBlockLines_UN3+"><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">lsblk</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_9IKF clean-btn">Copy</button></div></div><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>For this guide we'll be referencing our drive with the <strong>nvme0n1</strong> naming convention, remember to replace it with your drive's name when referencing it.</p></div></div><p>The following commands will create two partitions, one for boot and for the filesystem:</p><div class="codeBlockContainer_v8t5"><div class="codeBlockContent_sIJ5"><pre tabindex="0" class="prism-code language-undefined codeBlock_Olq5 thin-scrollbar" style="color: rgb(57, 58, 52); background-color: rgb(246, 248, 250);"><code class="codeBlockLines_UN3+"><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">gdisk /dev/nvme0n1</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_9IKF clean-btn">Copy</button></div></div><p>This will begin the gdisk program / prompt. Begin by creating the
EFI partition (choose size 550M and hex code EF00):</p><div class="codeBlockContainer_v8t5"><div class="codeBlockContent_sIJ5"><pre tabindex="0" class="prism-code language-undefined codeBlock_Olq5 thin-scrollbar" style="color: rgb(57, 58, 52); background-color: rgb(246, 248, 250);"><code class="codeBlockLines_UN3+"><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">Command (? for help): o</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">Command (? for help): n</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">Enter</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">Enter</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">+550M</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">EF00</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_9IKF clean-btn">Copy</button></div></div><p>The Boot Partition should now be created.
Let's create the File system partition.</p><div class="codeBlockContainer_v8t5"><div class="codeBlockContent_sIJ5"><pre tabindex="0" class="prism-code language-undefined codeBlock_Olq5 thin-scrollbar" style="color: rgb(57, 58, 52); background-color: rgb(246, 248, 250);"><code class="codeBlockLines_UN3+"><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">Command (? for help): n</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">Write the new partitions to disk:</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">Enter</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">Enter</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">Enter</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">Enter</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">Command (? for help): w</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_9IKF clean-btn">Copy</button></div></div><p>Now let's verify that our two partitions exist:</p><div class="codeBlockContainer_v8t5"><div class="codeBlockContent_sIJ5"><pre tabindex="0" class="prism-code language-undefined codeBlock_Olq5 thin-scrollbar" style="color: rgb(57, 58, 52); background-color: rgb(246, 248, 250);"><code class="codeBlockLines_UN3+"><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">lsblk</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_9IKF clean-btn">Copy</button></div></div><p>You should be able to see the two partitions available as <strong>/dev/nvme0n1p1</strong> and <strong>/dev/nvme0n1p2</strong>.</p><h2 class="anchor anchorWithStickyNavbar_iYD6" id="encryption">Encryption<a aria-hidden="true" class="hash-link" href="#encryption" title="Direct link to heading">‚Äã</a></h2><p>With your partitions set, create the encrypted container for your root file system.
Below is the command to encrypt the partition using LUKS:</p><div class="codeBlockContainer_v8t5"><div class="codeBlockContent_sIJ5"><pre tabindex="0" class="prism-code language-undefined codeBlock_Olq5 thin-scrollbar" style="color: rgb(57, 58, 52); background-color: rgb(246, 248, 250);"><code class="codeBlockLines_UN3+"><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">cryptsetup --cipher aes-exts-plain64 --hash sha256 --use-random --verify-passphrase luksFormat --type luks2 /dev/nvme0n1p2</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_9IKF clean-btn">Copy</button></div></div><p>Open the encrypted partition with:</p><div class="codeBlockContainer_v8t5"><div class="codeBlockContent_sIJ5"><pre tabindex="0" class="prism-code language-undefined codeBlock_Olq5 thin-scrollbar" style="color: rgb(57, 58, 52); background-color: rgb(246, 248, 250);"><code class="codeBlockLines_UN3+"><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">cryptsetup open /dev/nvme0n1p2 luks</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_9IKF clean-btn">Copy</button></div></div><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>("luks" is just a placeholder, you can use the name of your choice, but remember to continue the guide with your naming convention)</p></div></div><h2 class="anchor anchorWithStickyNavbar_iYD6" id="file-system-creation">File System Creation<a aria-hidden="true" class="hash-link" href="#file-system-creation" title="Direct link to heading">‚Äã</a></h2><p>Format the EFI partition with FAT32 and give it the label EFI:</p><div class="codeBlockContainer_v8t5"><div class="codeBlockContent_sIJ5"><pre tabindex="0" class="prism-code language-undefined codeBlock_Olq5 thin-scrollbar" style="color: rgb(57, 58, 52); background-color: rgb(246, 248, 250);"><code class="codeBlockLines_UN3+"><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">mkfs.vfat -F32 -n EFI /dev/nvme0n1p1</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_9IKF clean-btn">Copy</button></div></div><p>Format the root partition with BTRFS and give it the label ROOT:</p><div class="codeBlockContainer_v8t5"><div class="codeBlockContent_sIJ5"><pre tabindex="0" class="prism-code language-undefined codeBlock_Olq5 thin-scrollbar" style="color: rgb(57, 58, 52); background-color: rgb(246, 248, 250);"><code class="codeBlockLines_UN3+"><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">mkfs.btrfs -L ROOT /dev/mapper/luks</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_9IKF clean-btn">Copy</button></div></div><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>If you didn‚Äôt open the LUKS container under the name ‚Äúluks‚Äù you must adjust the command accordingly</p></div></div><h2 class="anchor anchorWithStickyNavbar_iYD6" id="create-and-mount-sub-volumes">Create and Mount Sub Volumes<a aria-hidden="true" class="hash-link" href="#create-and-mount-sub-volumes" title="Direct link to heading">‚Äã</a></h2><p>Create sub volumes for root, home, the package cache, snapshots, and the entire BTRFS file system:</p><div class="codeBlockContainer_v8t5"><div class="codeBlockContent_sIJ5"><pre tabindex="0" class="prism-code language-undefined codeBlock_Olq5 thin-scrollbar" style="color: rgb(57, 58, 52); background-color: rgb(246, 248, 250);"><code class="codeBlockLines_UN3+"><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">mount /dev/mapper/luks /mnt</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">btrfs sub create /mnt/@</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">btrfs sub create /mnt/@swap</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">btrfs sub create /mnt/@home</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">btrfs sub create /mnt/@pkg</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">btrfs sub create /mnt/@snapshots</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">umount /mnt</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_9IKF clean-btn">Copy</button></div></div><p>Mount the sub volumes:</p><div class="codeBlockContainer_v8t5"><div class="codeBlockContent_sIJ5"><pre tabindex="0" class="prism-code language-undefined codeBlock_Olq5 thin-scrollbar" style="color: rgb(57, 58, 52); background-color: rgb(246, 248, 250);"><code class="codeBlockLines_UN3+"><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">mount -o noatime,nodiratime,compress=zstd,space_cache=v2,ssd,subvol=@ /dev/mapper/luks /mnt</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">mkdir -p /mnt/{boot,home,var/cache/pacman/pkg,.snapshots,btrfs}</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">mount -o noatime,nodiratime,compress=zstd,space_cache=v2,ssd,subvol=@home /dev/mapper/luks /mnt/home</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">mount -o noatime,nodiratime,compress=zstd,space_cache=v2,ssd,subvol=@pkg /dev/mapper/luks /mnt/var/cache/pacman/pkg</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">mount -o noatime,nodiratime,compress=zstd,space_cache=v2,ssd,subvol=@snapshots /dev/mapper/luks /mnt/.snapshots</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">mount -o noatime,nodiratime,compress=zstd,space_cache=v2,ssd,subvolid=5 /dev/mapper/luks /mnt/btrfs</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_9IKF clean-btn">Copy</button></div></div><p>Mount the EFI partition:</p><div class="codeBlockContainer_v8t5"><div class="codeBlockContent_sIJ5"><pre tabindex="0" class="prism-code language-undefined codeBlock_Olq5 thin-scrollbar" style="color: rgb(57, 58, 52); background-color: rgb(246, 248, 250);"><code class="codeBlockLines_UN3+"><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">mount /dev/nvme0n1p1 /mnt/boot</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_9IKF clean-btn">Copy</button></div></div><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>Optional - The following is for those wanting to use a swapfile.</p></div></div><p>Create swap file (taken from Btrfs - Swap file and Swap file):</p><div class="codeBlockContainer_v8t5"><div class="codeBlockContent_sIJ5"><pre tabindex="0" class="prism-code language-undefined codeBlock_Olq5 thin-scrollbar" style="color: rgb(57, 58, 52); background-color: rgb(246, 248, 250);"><code class="codeBlockLines_UN3+"><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">cd /mnt/btrfs/@swap</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">truncate -s 0 ./swapfile</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">chattr +C ./swapfile</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">btrfs property set ./swapfile compression none</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">dd if=/dev/zero of=./swapfile bs=1M count=&lt;FILE-SIZE-IN-MiB&gt; status=progress</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">chmod 600 ./swapfile</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">mkswap ./swapfile</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">swapon ./swapfile</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">cd -</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_9IKF clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_iYD6" id="base-system-and-etcfstab">Base System and /etc/fstab<a aria-hidden="true" class="hash-link" href="#base-system-and-etcfstab" title="Direct link to heading">‚Äã</a></h2><p>With your subvolumes created and mounted, you are now ready to install Arch Linux.
For our machine we will be using <a href="https://wiki.archlinux.org/title/microcode" target="_blank" rel="noopener noreferrer">intel-ucode</a> as the X1 has an intel CPU setup</p><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>If your machine has an AMD CPU, replace <strong>intel-ucode</strong> with <a href="https://archlinux.org/packages/?name=amd-ucode" target="_blank" rel="noopener noreferrer">amd-ucode</a>.
Feel free to add any other packages you want to install at this time in the command below.</p></div></div><div class="codeBlockContainer_v8t5"><div class="codeBlockContent_sIJ5"><pre tabindex="0" class="prism-code language-undefined codeBlock_Olq5 thin-scrollbar" style="color: rgb(57, 58, 52); background-color: rgb(246, 248, 250);"><code class="codeBlockLines_UN3+"><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">pacstrap /mnt linux linux-firmware base btrfs-progs intel-ucode nano networkmanager git</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_9IKF clean-btn">Copy</button></div></div><p>Generate /etc/fstab:</p><div class="codeBlockContainer_v8t5"><div class="codeBlockContent_sIJ5"><pre tabindex="0" class="prism-code language-undefined codeBlock_Olq5 thin-scrollbar" style="color: rgb(57, 58, 52); background-color: rgb(246, 248, 250);"><code class="codeBlockLines_UN3+"><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">genfstab -U /mnt &gt;&gt; /mnt/etc/fstab</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_9IKF clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_iYD6" id="system-configuration">System Configuration<a aria-hidden="true" class="hash-link" href="#system-configuration" title="Direct link to heading">‚Äã</a></h2><p>This is where you'll be managing system configurations. In our case we're configuring this as an American user, but
for those of you reading outside the US, set the language and keyboard bindings to your locale.</p><p>CHROOT into the new system:</p><div class="codeBlockContainer_v8t5"><div class="codeBlockContent_sIJ5"><pre tabindex="0" class="prism-code language-undefined codeBlock_Olq5 thin-scrollbar" style="color: rgb(57, 58, 52); background-color: rgb(246, 248, 250);"><code class="codeBlockLines_UN3+"><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">arch-chroot /mnt/</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_9IKF clean-btn">Copy</button></div></div><p>Set the hostname:</p><div class="codeBlockContainer_v8t5"><div class="codeBlockContent_sIJ5"><pre tabindex="0" class="prism-code language-undefined codeBlock_Olq5 thin-scrollbar" style="color: rgb(57, 58, 52); background-color: rgb(246, 248, 250);"><code class="codeBlockLines_UN3+"><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">echo &lt;YOUR-HOSTNAME&gt; &gt; /etc/hostname</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_9IKF clean-btn">Copy</button></div></div><p>Set locale:</p><div class="codeBlockContainer_v8t5"><div class="codeBlockContent_sIJ5"><pre tabindex="0" class="prism-code language-undefined codeBlock_Olq5 thin-scrollbar" style="color: rgb(57, 58, 52); background-color: rgb(246, 248, 250);"><code class="codeBlockLines_UN3+"><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">echo LANG=en_US.UTF-8 &gt; /etc/locale.conf</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_9IKF clean-btn">Copy</button></div></div><p>Uncomment the following rows in /etc/locale.gen:</p><div class="codeBlockContainer_v8t5"><div class="codeBlockContent_sIJ5"><pre tabindex="0" class="prism-code language-undefined codeBlock_Olq5 thin-scrollbar" style="color: rgb(57, 58, 52); background-color: rgb(246, 248, 250);"><code class="codeBlockLines_UN3+"><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">en_US.UTF-8.UTF-8</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_9IKF clean-btn">Copy</button></div></div><p>Generate locale:</p><div class="codeBlockContainer_v8t5"><div class="codeBlockContent_sIJ5"><pre tabindex="0" class="prism-code language-undefined codeBlock_Olq5 thin-scrollbar" style="color: rgb(57, 58, 52); background-color: rgb(246, 248, 250);"><code class="codeBlockLines_UN3+"><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">locale-gen</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_9IKF clean-btn">Copy</button></div></div><p>Define hosts in /etc/hosts:</p><div class="codeBlockContainer_v8t5"><div class="codeBlockContent_sIJ5"><pre tabindex="0" class="prism-code language-undefined codeBlock_Olq5 thin-scrollbar" style="color: rgb(57, 58, 52); background-color: rgb(246, 248, 250);"><code class="codeBlockLines_UN3+"><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">&lt;ip-address&gt;    &lt;hostname.domain.org&gt;   &lt;hostname&gt;</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">127.0.0.1   &lt;YOUR-HOSTNAME&gt;.localdomain &lt;YOUR-HOSTNAME&gt;</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">::1     localhost.localdomain   localhost</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_9IKF clean-btn">Copy</button></div></div><p>Set the root user's password:</p><p>(We recommend setting a secure password for your newly created root user.)</p><div class="codeBlockContainer_v8t5"><div class="codeBlockContent_sIJ5"><pre tabindex="0" class="prism-code language-undefined codeBlock_Olq5 thin-scrollbar" style="color: rgb(57, 58, 52); background-color: rgb(246, 248, 250);"><code class="codeBlockLines_UN3+"><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">passwd</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_9IKF clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_iYD6" id="initramfs">Initramfs<a aria-hidden="true" class="hash-link" href="#initramfs" title="Direct link to heading">‚Äã</a></h2><p>Configure the creation of initramfs by editing /etc/mkinitcpio.conf. Edit the line <code>HOOKS=...</code> to:</p><div class="codeBlockContainer_v8t5"><div class="codeBlockContent_sIJ5"><pre tabindex="0" class="prism-code language-undefined codeBlock_Olq5 thin-scrollbar" style="color: rgb(57, 58, 52); background-color: rgb(246, 248, 250);"><code class="codeBlockLines_UN3+"><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">HOOKS=(base keyboard udev autodetect modconf block keymap encrypt btrfs filesystems resume)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_9IKF clean-btn">Copy</button></div></div><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p><code>resume</code> in the above hooks is for those of you setting up a swap partition. If you don't intend to use swap, you can simply remove it.</p></div></div><p>Recreate initramfs:</p><div class="codeBlockContainer_v8t5"><div class="codeBlockContent_sIJ5"><pre tabindex="0" class="prism-code language-undefined codeBlock_Olq5 thin-scrollbar" style="color: rgb(57, 58, 52); background-color: rgb(246, 248, 250);"><code class="codeBlockLines_UN3+"><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">mkinitcpio -p linux</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_9IKF clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_iYD6" id="boot-manager">Boot Manager<a aria-hidden="true" class="hash-link" href="#boot-manager" title="Direct link to heading">‚Äã</a></h2><p>Install systemd-boot:</p><div class="codeBlockContainer_v8t5"><div class="codeBlockContent_sIJ5"><pre tabindex="0" class="prism-code language-undefined codeBlock_Olq5 thin-scrollbar" style="color: rgb(57, 58, 52); background-color: rgb(246, 248, 250);"><code class="codeBlockLines_UN3+"><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">bootctl --path=/boot install</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_9IKF clean-btn">Copy</button></div></div><p>Create file /boot/loader/entries/arch.conf and fill it with:</p><div class="codeBlockContainer_v8t5"><div class="codeBlockContent_sIJ5"><pre tabindex="0" class="prism-code language-undefined codeBlock_Olq5 thin-scrollbar" style="color: rgb(57, 58, 52); background-color: rgb(246, 248, 250);"><code class="codeBlockLines_UN3+"><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">title Arch Linux</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">linux /vmlinuz-linux</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">initrd /intel-ucode.img</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">initrd /initramfs-linux.img</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">options cryptdevice=UUID=&lt;UUID-OF-ROOT-PARTITION&gt;:luks:allow-discards root=/dev/mapper/luks rootflags=subvol=@ rd.luks.options=discard rw</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_9IKF clean-btn">Copy</button></div></div><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>Optional - If you are using a swap, add the following to the options flag.
You will also need to follow this guide to calculate your <a href="https://wiki.archlinux.org/title/Power_management/Suspend_and_hibernate#Hibernation_into_swap_file_on_Btrfs" target="_blank" rel="noopener noreferrer">offset</a></p></div></div><div class="codeBlockContainer_v8t5"><div class="codeBlockContent_sIJ5"><pre tabindex="0" class="prism-code language-undefined codeBlock_Olq5 thin-scrollbar" style="color: rgb(57, 58, 52); background-color: rgb(246, 248, 250);"><code class="codeBlockLines_UN3+"><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">resume=/dev/mapper/luks resume_offset=&lt;YOUR-OFFSET&gt;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_9IKF clean-btn">Copy</button></div></div><p>Provide the UUID of your root partition:</p><div class="codeBlockContainer_v8t5"><div class="codeBlockContent_sIJ5"><pre tabindex="0" class="prism-code language-undefined codeBlock_Olq5 thin-scrollbar" style="color: rgb(57, 58, 52); background-color: rgb(246, 248, 250);"><code class="codeBlockLines_UN3+"><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">blkid -s UUID -o value /dev/sda2</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_9IKF clean-btn">Copy</button></div></div><p>Replace <code>UUID-OF-ROOT</code> in /boot/loader/entries/arch.conf</p><p>Edit /boot/loader/loader.conf and fill it with:</p><div class="codeBlockContainer_v8t5"><div class="codeBlockContent_sIJ5"><pre tabindex="0" class="prism-code language-undefined codeBlock_Olq5 thin-scrollbar" style="color: rgb(57, 58, 52); background-color: rgb(246, 248, 250);"><code class="codeBlockLines_UN3+"><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">default  arch.conf</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">timeout  4</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">console-mode max</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">editor   no</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_9IKF clean-btn">Copy</button></div></div><p>Lastly, exit chroot, unmount your partition, and reboot:</p><div class="codeBlockContainer_v8t5"><div class="codeBlockContent_sIJ5"><pre tabindex="0" class="prism-code language-undefined codeBlock_Olq5 thin-scrollbar" style="color: rgb(57, 58, 52); background-color: rgb(246, 248, 250);"><code class="codeBlockLines_UN3+"><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">exit</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">umount -R /mnt</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">reboot</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_9IKF clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_iYD6" id="installation-complete">Installation Complete<a aria-hidden="true" class="hash-link" href="#installation-complete" title="Direct link to heading">‚Äã</a></h2><p>Congratulations, you now have Arch running on your laptop!</p><p>You now have an encrypted partition of Arch Linux running on your laptop with a root user and networking.</p><h2 class="anchor anchorWithStickyNavbar_iYD6" id="whats-left-to-do">What's left to do?<a aria-hidden="true" class="hash-link" href="#whats-left-to-do" title="Direct link to heading">‚Äã</a></h2><ul><li>Sign in as root on your laptop</li><li>Setup a user with sudo privileges</li><li>Setup a Window Manager / Desktop Environment</li><li>Install YAY and AUR</li><li>Generate SSH Keys</li><li>Generate GPG Keys</li><li>Find ways to interject into conversations that you now use Arch</li></ul><h3 class="anchor anchorWithStickyNavbar_iYD6" id="references">References<a aria-hidden="true" class="hash-link" href="#references" title="Direct link to heading">‚Äã</a></h3><ul><li><a href="https://nerdstuff.org/posts/2020/2020-004_arch_linux_luks_btrfs_systemd-boot/" target="_blank" rel="noopener noreferrer">Nerd Stuff Guide</a></li><li><a href="https://github.com/ejmg/an-idiots-guide-to-installing-arch-on-a-lenovo-carbon-x1-gen-6#partitioning-and-configuring" target="_blank" rel="noopener noreferrer">EJMG's Guide</a></li><li><a href="https://austinmorlan.com/posts/arch_linux_install/" target="_blank" rel="noopener noreferrer">AustinMorlin</a></li></ul></div><footer class="row docusaurus-mt-lg blogPostDetailsFull_W2UL"><div class="col"><b>Tags:</b><ul class="tags_Y-c7 padding--none margin-left--sm"><li class="tag_4Dzs"><a class="tag_g3F1 tagRegular_x2fW" href="https://www.lunasec.io/docs/blog/tags/developer-tools/">developer-tools</a></li><li class="tag_4Dzs"><a class="tag_g3F1 tagRegular_x2fW" href="https://www.lunasec.io/docs/blog/tags/install-guides/">install-guides</a></li><li class="tag_4Dzs"><a class="tag_g3F1 tagRegular_x2fW" href="https://www.lunasec.io/docs/blog/tags/archlinux/">archlinux</a></li><li class="tag_4Dzs"><a class="tag_g3F1 tagRegular_x2fW" href="https://www.lunasec.io/docs/blog/tags/arch/">arch</a></li></ul></div><div class="col margin-top--sm"><a href="https://github.com/lunasec-io/lunasec/edit/master/docs/blog/blog/2022-05-02-arch-linux-installation-guide.mdx" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_TyZ3" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="https://www.lunasec.io/docs/blog/the-issue-with-vuln-scanners/"><div class="pagination-nav__sublabel">Newer Post</div><div class="pagination-nav__label">¬´ False Positives in Vulnerability Scanning: Why We Think We Can Do Better</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="https://www.lunasec.io/docs/blog/spring-rce-vulnerabilities/"><div class="pagination-nav__sublabel">Older Post</div><div class="pagination-nav__label">Spring4Shell: Security Analysis of the latest Java RCE '0-day' vulnerabilities in Spring ¬ª</div></a></div></nav></main><div class="col col--2"><div class="tableOfContents_tLwr thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#btw-we-use-arch" class="table-of-contents__link toc-highlight">BTW we use Arch</a></li><li><a href="#why-is-arch-the-best-operating-system-for-developers" class="table-of-contents__link toc-highlight">Why is Arch the best operating system for developers?</a></li><li><a href="#preparing-for-the-install" class="table-of-contents__link toc-highlight">Preparing For the Install</a></li><li><a href="#what-were-installing" class="table-of-contents__link toc-highlight">What We're Installing</a></li><li><a href="#beginning-the-install" class="table-of-contents__link toc-highlight">Beginning the Install</a></li><li><a href="#enabling-ssh" class="table-of-contents__link toc-highlight">Enabling SSH</a></li><li><a href="#installation-overview" class="table-of-contents__link toc-highlight">Installation Overview</a></li><li><a href="#create-the-boot-and-filesystem-partitions" class="table-of-contents__link toc-highlight">Create the Boot and Filesystem partitions</a></li><li><a href="#encryption" class="table-of-contents__link toc-highlight">Encryption</a></li><li><a href="#file-system-creation" class="table-of-contents__link toc-highlight">File System Creation</a></li><li><a href="#create-and-mount-sub-volumes" class="table-of-contents__link toc-highlight">Create and Mount Sub Volumes</a></li><li><a href="#base-system-and-etcfstab" class="table-of-contents__link toc-highlight">Base System and /etc/fstab</a></li><li><a href="#system-configuration" class="table-of-contents__link toc-highlight">System Configuration</a></li><li><a href="#initramfs" class="table-of-contents__link toc-highlight">Initramfs</a></li><li><a href="#boot-manager" class="table-of-contents__link toc-highlight">Boot Manager</a></li><li><a href="#installation-complete" class="table-of-contents__link toc-highlight">Installation Complete</a></li><li><a href="#whats-left-to-do" class="table-of-contents__link toc-highlight">What's left to do?</a><ul><li><a href="#references" class="table-of-contents__link toc-highlight">References</a></li></ul></li></ul></div></div></div></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="https://www.lunasec.io/docs/blog/">Blog</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/lunasec-io/lunasec" target="_blank" rel="noopener" class="footer__link-item github-nav-link"><span> GitHub (Star Us üíï)<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_x5Nv"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://github.com/lunasec-io/lunasec/discussions" target="_blank" rel="noopener" class="footer__link-item"><span>Forums<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_x5Nv"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">LunaSec</div><ul class="footer__items"><li class="footer__item"><a href="https://www.lunasec.io/" target="_blank" rel="noopener" class="footer__link-item">Website</a></li><li class="footer__item"><a href="https://www.lunasec.io/contact" target="_blank" rel="noopener" class="footer__link-item">Contact Us</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright ¬© 2022 LunaSec. Built with Docusaurus.</div></div></div></footer></div>



<noscript><img src="https://sa.lunasec.io/noscript.gif" alt="" referrerpolicy="no-referrer-when-downgrade" /></noscript>
